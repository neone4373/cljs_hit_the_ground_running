#! /usr/bin/env phantomjs

// if (phantom.args.length != 1) {
//     console.log('Expected a target URL parameter.');
//     console.log(phantom.args);
//     phantom.exit(1);
// }


var fs = require("fs");
var p = require('webpage').create();
var sys = require('system');
var url = phantom.args[0];

p.onConsoleMessage = function (x) {
    fs.write("/dev/stdout", x, "w");
    // console.log("Test console: " + x);
};

// p.open(url, function (status) {
//     if (status != "success") {
//         console.log('Failed to open ' + url);
//         phantom.exit(1);
//     }

p.injectJs("resources/public/js/polyfill.js");

p.injectJs(phantom.args[0]);

// console.log(p.content)

var result = p.evaluate(function () {
    speclj.run.standard.armed = true;
    return speclj.run.standard.run_specs(
        cljs.core.keyword("color"), true
        // ,cljs.core.keyword("stacktrace"), false

    );
});

// console.log( result);


phantom.exit(result);
// });
